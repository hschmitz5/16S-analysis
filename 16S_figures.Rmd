---
title: "16S Analysis"
author: "Hannah Schmitz"
date: "`r Sys.Date()`"
output: 
  powerpoint_presentation:
    reference_doc: null  # optional, use a custom template if desired
---

# Ordination
```{r ordination, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=3}
source("./code/R/plot_ordination.R")

knitr::include_graphics(fname_ord)
```

# ANOSIM (wunifrac)
```{r anosim, echo=FALSE, warning=FALSE, message=FALSE, out.width='100%'}
source("./code/R/plot_anosim.R")

print(anosim_plot)
```

# Diversity
```{r diversity, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=3}
source("./code/R/plot_diversity.R")

knitr::include_graphics(fname_div)
```


```{r, include=FALSE, results='hide', message=FALSE, warning=FALSE}
# Temporarily disable knitrâ€™s graphics device capturing
knitr::knit_hooks$set(plot = function(x, options) NULL)

# Suppress all drawing to PowerPoint
pdf(file = tempfile())
source("./code/R/plot_rel_heatmap.R")
source("./code/R/plot_DA_ancom.R")
dev.off()

# Restore knitr plot hook
knitr::knit_hooks$restore()

```

# DA Taxa
```{r da_taxa, echo=FALSE, warning=FALSE, message=FALSE, out.width='100%'}
library(magick)

fname_out <- "./figures/combined_heatmaps.png"

# Read the PNGs
img1 <- image_read(fname_rel)
img2 <- image_read(fname_high)
combined <- image_append(c(img1, img2), stack = FALSE)
image_write(combined, fname_out)

knitr::include_graphics(fname_out)

```