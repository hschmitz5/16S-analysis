---
title: "child_diversity"
output: html_document
date: "2025-10-24"
---

# Alpha Diversity - Shannon

```{r diversity_plot}
div_type = c("Shannon")
filename <- paste0("../figures/diversity_", div_type, ".png")

p <- plot_richness(ps_ASV, x = "size.mm", measures = div_type) +
  geom_point(size=2) +
  labs(
    title = div_type,
    x = "Sieve Range [mm]"
  ) +
  theme_minimal(base_size = 14) +
  theme(strip.text = element_blank()) # removes default title

# Save the plot
ggsave(filename, plot = p, width = 6, height = 4, dpi = 300)
print(p)

```

# Faith's Phylogenetic Diversity Index

```{r diversity_Faith}
library(picante)

metadata <- get_metadata(ps_ASV)

comm <- as.data.frame(as.matrix(ps_ASV@otu_table)) %>%
  t() 

phy <- ps_ASV@phy_tree

pd_results <- pd(comm, phy) %>%
  rownames_to_column(var = "Sample") %>%
  left_join(metadata, join_by(Sample))

head(pd_results)

# plot
pd_results %>%
    ggplot(aes(x = size.mm, y = PD)) +
    geom_point(size = 2) +
    labs(
      title = "Faith's phylogenetic diversity index",
      x = "Sieve Range [mm]",
      y = "Alpha Diversity Measure",
    ) +
    theme_minimal(base_size = 14)   # sets text size

filename <- paste0("../figures/diversity_Faith.png")
ggsave(filename, width = 6, height = 4, dpi = 300)
```